function setAuthorization(e,t,a,r,n){mUrl=e,mAppKey=t,mApi=a,mAppSecret=r,mSeq=n}function setCallBackFromServerResult(e){callBack=e}function uploadSpeexData(e){var t=(e[0],(new Date).getTime()),a=mAppSecret+"api="+mApi+"appkey="+mAppKey+"timestamp="+t+mAppSecret,r=$.md5(a),n=mUrl+"?appkey="+mAppKey+"&api="+mApi+"&timestamp="+t+"&sign="+r+"&seq="+mSeq+"&compress=1";if(window.FileReader){var i=new FileReader;i.readAsArrayBuffer(e),i.onloadend=function(){var e=new Uint8Array(this.result),t=e.subarray(0),a=new Int16Array(t.buffer),r=new Speex({quality:10,mode:1,bits_size:70}),i=r.encode(a,!0),l=new Blob(i),s=new FileReader;s.readAsArrayBuffer(l),s.onloadend=function(){$.ajax({url:n,data:this.result,type:"POST",dataType:"text",processData:!1,headers:{"Content-Type":"application/octet-stream"},xhrFields:{withCredentials:!0},success:function(e){interval=setInterval(getServerResult,500,n)},error:function(e){}})}}}}function getServerResult(e){var t=e+"&stop=1";$.ajax({url:t,type:"GET",dataType:"json",async:!1,xhrFields:{withCredentials:!0},success:function(e){result=e,intervalCount++,(result.data&&result.data.asr&&result.data.asr["final"]||intervalCount>20)&&(clearInterval(interval),callBack(JSON.stringify(result)),intervalCount=0,clearInterval(interval))},error:function(e){callBack(JSON.stringify(e)),intervalCount=0,clearInterval(interval)}})}var mUrl,mAppKey,mApi,mAppSecret,mSeq,callBack,interval,intervalCount=0;